<!DOCTYPE html>
<html>

<head>
  <link href="styles.css" rel="stylesheet" type="text/css">
  <script src="https://unpkg.com/jspsych"></script>
  <script src="../dist/index.browser.js"></script>
  <link href="https://unpkg.com/jspsych/css/jspsych.css" rel="stylesheet" type="text/css">
</head>

<body></body>
<script>
  const jsPsych = initJsPsych({
    on_finish: function () {
      jsPsych.data.displayData();
      // jsPsych.data.get().localSave("csv", "llm_trial.csv");
    },
  });

  // Declaring the prompts necessary
  prompts = [
    {
      message: "Welcome to the chatroom!",
      role: "system-prompt",
      message_trigger: 0
    },

    //timer trigger in ms
    //"chatbot" = chatbot will say the thing typed in the prompt
    {
      message: "Hey there! I'm Adorabot, here to chat about a disputed topic in the U.S. Which topic would you like to discuss: human euthanasia, gender inequality, the role of the government in healthcare, the atomic bombing of Hiroshima and Nagasaki, mandating vaccines, criminal justice reforms, or same- sex marriage. Let me know what you want to talk about!",
      role: "chatbot-message",
      message_trigger: 0
    }
  ]
  
  prompt_chain = {
      message_trigger: 1,
      prompts: [`Concisely summarize the user's stance. From the user's stance, determine whether to widen the user's perspective, it would be better to: 
      1) ask the user about their experience and why they think the way they do, 
      2) correct the user for factual information inaccuracy, or
      3) share a different experience that differed from the user's. Share the perspective of a person with different views.
        Change up your way of widening the user's perspective each time.`,
      `Repeat the user input without repeating yourself. If you ask about the user experience more than once, share a different experience instead. Do not greet the user, do not say certainly.`
      /*`Repeat the user input without greeting the user. Do not repeat what you said before.`*/], // Ask the user what has led them to believe in the argument below.
    }

    //"First, reiterate the user's statement. Second, you want to improve the user's open-mindedness and willingness to converse about this topic with others. Identify whether it would be most successful to do so by asking the user a deeper question about their beliefs based on what they've just stated, by providing a counter argument to the user's beliefs and asking what the user thinks, or by explaining why some people have different views from the user's views and asking what the user thinks."
    // "In one sentence, akcnowledge the user's perspective. Then, in a couple sentences, comply with the information below. Do not explicitly state that you are trying to expand open-mindedness or willingness to converse, or that you have selected a specific approach for responding to the user. Be conversational. Do not overgeneralize."
    //First, concisely summarize the user's stance. Second, from the user's stance, determine whether to widen the user's perspective, it would be better to 1) ask the user about their experience and why they think the way they do 2) provide information that disproves the user's belief or 3) share alternative perspectives of other people that disagree with the user's belief.

  continue_button = {
    message_trigger: 0,
    message: "You have completed your six rounds of messages with Adorabot! Click continue to proceed with the experiment.",
  }

  const trial = {
    type: jsPsychChat,
    ai_prompt: "Ask the user what their views are.",
    continue_button: continue_button,
    chat_field_placeholder: "Share your perspective...",
    additional_prompts: prompts,
    prompt_chain: prompt_chain
  }
  //past prompts
  // "In a conversational tone, concisely present specific counterarguments to the user's points. Briefly acknowledge the user's point and ask for their specific thought on your response."

  jsPsych.run([trial]);
</script>

</html>